<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <title>Your E-commerce Website</title>
  <link href="https://cdn.jsdelivr.net/npm/remixicon@4.0.0/fonts/remixicon.css" rel="stylesheet"   />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
    crossorigin="anonymous"></script>
  <style>
    body {
      padding-top: 56px;
    }
  </style>
</head>

<body>

  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg navbar-light bg-dark fixed-top p-3">
    <a style="color: #0F0;" class="navbar-brand" href=""><b><em>Fonekart</em></b></a>
    <button class="navbar-toggler bg-light" type="button" data-toggle="collapse" data-target="#navbarNav"
      aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class=" navbar-collapse" id="navbarNav" style="visibility: visible;">
      <ul class="navbar-nav ml-auto" class="navv">

        <li class="nav-item">
          <a style="color: white;" class="nav-link" href=" /home"> <i class="ri-home-8-line"></i></a>
        </li>
        <li class="nav-item">
          <a style="color: white;" class="nav-link" href="/cart"><i class="ri-shopping-cart-line"></i></a>
        </li>
        <li class="nav-item">
          <a style="color: white;" class="nav-link" href=""><i class="ri-heart-line"></i></a>
        </li>
        <li class="nav-item">
          <a style="color: white;" class="nav-link" href="/home/profile"><i class="ri-account-circle-line"></i></a>
        </li>
        <!-- Add more navbar items as needed -->
      </ul>

    </div>
  </nav>

  <!-- Ordered Products Table -->
  <div class="container mt-5">
    <h2 style="padding-bottom: 10px; color: chocolate;">Ordered Products</h2>
    <table class="table">
      <thead>
        <tr>
          <th scope="col">Image</th>
          <th scope="col">Product</th>
          <th scope="col">Quantity</th>
          <th scope="col">Price</th>
          <th scope="col">Date</th>
          <th scope="col">Status</th>
          <th scope="col">Action</th>
        </tr>
      </thead>
      <tbody>
        <!-- < if(typeof OrderData !=='undefined' ){ %> -->
        <% for(let i=0 ; i<OrderData.length ; i++) {%>
          <tr>
            <td>
              <a href="#" data-toggle="modal" data-target="#orderModal_<%= OrderData[i].orderItems._id %>">
                <img src="<%= OrderData[i].orderItems.Image[0] %>" alt="image" class="img-thumbnail"
                  style="max-width: 100px;">
              </a>
              <div class="modal fade" id="orderModal_<%= OrderData[i].orderItems._id %>" tabindex="-1" role="dialog" aria-labelledby="orderModalLabel" aria-hidden="true">
                <div class="modal-dialog modal-lg" role="document">
                  <div class="modal-content `">
                    <div class="modal-header">
                      <h5 class="modal-title" id="orderModalLabel">Ordered product Details</h5>
                      <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                      </button>
                    </div>
                    <div class="modal-body">
                      <h6>Product Details:</h6>
                      <table class="table">
                        <tbody>
                          <tr>
                            <th>Image</th>
                            <th>Quantity</th>
                            <th>Category</th>
                            <th>Price</th>
                          </tr>
                          <tr>
                            <td><img src="<%= OrderData[i].orderItems.Image[0] %>" alt="product image" style="max-width: 100px;"></td>
                            <td><%= OrderData[i].orderItems.Pname %></td>
                            <td><%= OrderData[i].orderItems.quantity %></td>
                            <td><%= OrderData[i].orderItems.Pcategory %></td>
                            <td><%= OrderData[i].orderItems.price %></td>
                          </tr>
                        </tbody>
                      </table>
                      <h6>User Details:</h6>
                      
                     
                         
                            <p>Name:</p>
                            <p>Address:</p>
                            <p>Pin:</p>
                            <p>Phone:</p>
                            <td><%#= OrderData[i].user.name %></td>
                            <td><%#= OrderData[i].user.address %></td>
                            <td><%#= OrderData[i].user.pin %></td>
                            <td><%#= OrderData[i].user.phone %></td>    
                      
                    </div>
                    
                  </div>
                </div>
              </div>
              
            </td>
            <td>
              <%= OrderData[i].orderItems.Pname %>
            </td>
            <td>
              <%= OrderData[i].orderItems.quantity %>
            </td>
            <td><b>₹</b>
              <%= OrderData[i].orderItems.price %>
            </td>
            <td>
              <%= new Date(OrderData[i].orderDate).toLocaleDateString() %>
            </td>
            <% if(OrderData[i].orderItems.orderStatus=='ordered' ){ %>
              <td style="color: green;">
                <%= OrderData[i].orderItems.orderStatus%>
              </td>
              <% }else if(OrderData[i].orderItems.orderStatus=='canceled' ){ %>
                <td style="color: rgb(255, 0, 0); ">
                  <%= OrderData[i].orderItems.orderStatus%>
                </td>
                <% }else if(OrderData[i].orderItems.orderStatus=='delivered' ){ %>
                  <td style="color: rgb(179, 0, 255); ">
                    <%= OrderData[i].orderItems.orderStatus%>
                  </td>
                  <% }else if(OrderData[i].orderItems.orderStatus=='shipped' ){ %>
                    <td style="color: rgb(255, 0, 230); ">
                      <%= OrderData[i].orderItems.orderStatus%>
                    </td>
                    <% }else if(OrderData[i].orderItems.orderStatus=='returned' ){ %>
                      <td style="color: rgb(255, 0, 230); ">
                        <%= OrderData[i].orderItems.orderStatus%>
                      </td>
                      <% } %>


                        <% if(OrderData[i].orderItems.orderStatus=='ordered' ){ %>
                          <td>
                            <button class="btn btn-danger" data-toggle="modal"
                              data-target="#confirmationModal<%= i %>">Cancel</button>
                          </td>
                          <% }else if(OrderData[i].orderItems.orderStatus=='delivered' ){ %>
                            <td>
                              <a href="/returnOrder?id=<%= OrderData[i].orderItems._id %>"><button
                                  class="btn btn-warning">Return</button></a>
                            </td>
                            <% } %>
                              <div class="modal" tabindex="-1" role="dialog" id="confirmationModal<%= i %>">
                                <div class="modal-dialog" role="document">
                                  <div class="modal-content">
                                    <div class="modal-header">
                                      <h5 class="modal-title">Confirmation</h5>
                                      <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">&times;</span>
                                      </button>
                                    </div>
                                    <div class="modal-body">
                                      Are you sure you want to cancel this order?
                                    </div>
                                    <div class="modal-footer">
                                      <button type="button" class="btn btn-secondary"
                                        data-dismiss="modal">Cancel</button>
                                      <a href="/api/cancelOrder?id=<%= OrderData[i].orderItems._id %>"
                                        class="btn btn-danger">Confirm Cancel</a>
                                    </div>
                                  </div>
                                </div>
                              </div>

          </tr>
          <% } %>
            <%# } %>





      </tbody>
    </table>
  </div>

  <form>
    <div class="col-12 pb-1 ">
      <nav aria-label="Page navigation">
        <ul class="pagination justify-content-center mb-3">
          <% for (let i=1; i <=totalPages; i++) { %>
            <li class="page-item">
              <a class="page-link" href="?page=<%= i %>">
                <%= i %>
              </a>
            </li>
            <% } %>
        </ul>
      </nav>
    </div>
  </form>

  <footer class="bg-dark text-light pt-5  pb-3 " id="footer" style="width: 100%; margin-top: 180px;">
    <div class="container" style="padding: 30px;">
      <div class="row" style="width: 100%;">
        <div class="col-md-4">
          <a style="color: #0F0;" class="navbar-brand" href=""><b><em>About Us</em></b></a>
          <p>E-commerce platform</p>
        </div>
        <div class="col-md-4">
          <a style="color: #0F0;" class="navbar-brand" href=""><b><em>Contact Us</em></b></a>
          <p>Email: Fonekart@gmail.com<br>Phone: 7558001145</p>
        </div>
        <div class="col-md-4">
          <a style="color: #0F0;" class="navbar-brand" href=""><b><em>Follow Us</em></b></a>
          <ul class="list-inline">
            <li class="list-inline-item"><a style="text-decoration: none;" class="text-light"
                href="https://wa.me/qr/QLG7ZQPTHYSDH1">Watsapp</a></li>
            <br>
            <li class="list-inline-item"><a style="text-decoration: none;" class="text-light"
                href="https://www.facebook.com/siyad.siyu.37?mibextid=ZbWKwL">Facebook</a>
            </li>
            <br>
            <li class="list-inline-item"><a style="text-decoration: none;" class="text-light"
                href="https://instagram.com/siyad___._10?igshid=OGQ5ZDc2ODk2ZA==">Instagram</a></li>
          </ul>
        </div>
      </div>
    </div>
  </footer>

  <!-- Bootstrap JS and Popper.js (required for Bootstrap components to work) -->
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

</body>

</html>