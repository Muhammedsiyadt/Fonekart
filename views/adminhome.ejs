<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<!-- Boxicons -->
	<link href='https://unpkg.com/boxicons@2.0.9/css/boxicons.min.css' rel='stylesheet'>
	<!-- My CSS -->
	<link rel="stylesheet" href="css/adminhome.css">

	<title>Fonekart</title>
</head>

<body>



	<section id="sidebar" style="background-color: white;">

		<h1 style="margin-left: 45px; margin-top: 20px; font-size: 45px;">Fonekart</h1>
		<ul class="side-menu top">
			<li class="active">
				<a href="/adminhome">
					<i class='bx bxs-dashboard'></i>
					<span class="text">Dashboard</span>
				</a>
			</li>
			<li>
				<a href="/product_management">
					<i class='bx bxs-shopping-bag-alt'></i>
					<span class="text">Product Management</span>
				</a>
			</li>
			<li>
				<a href="/User_management">
					<i class='bx bxs-doughnut-chart'></i>
					<span class="text">User Management</span>
				</a>
			</li>
			<li>
				<a href="/Order_management">
					<i class='bx bxs-message-dots'></i>
					<span class="text">Order Management</span>
				</a>
			</li>
			<li>
				<a href="/Categary_management">
					<i class='bx bxs-group'></i>
					<span class="text">Categary Management</span>
				</a>
			</li>
			<li>
				<a href="/Coupon_management">
					<i class='bx bxs-group'></i>
					<span class="text">Coupon Management</span>
				</a>
			</li>
			<li>
				<a href="/Offer_management">
					<i class='bx bxs-group'></i>
					<span class="text">Offer_Management</span>
				</a>
			</li>
			<li>
				<a href="/refferalOffer">
					<i class='bx bxs-group'></i>
					<span class="text">Refferal_Offer</span>
				</a>
			</li>
		</ul>
		<ul class="side-menu">
			<li>
				<a href="/adminLogout" class="logout">
					<i class='bx bxs-log-out-circle'></i>
					<span class="text">Logout</span>
				</a>
			</li>
		</ul>
	</section>






	<section id="content">
		<main>


			<div style="margin-top: 10px;">
				<button class="download-button" style="" onclick="openModal()">
					<div class="docs"><svg class="css-i6dzq1" stroke-linejoin="round" stroke-linecap="round" fill="none"
							stroke-width="2" stroke="currentColor" height="15" width="20" viewBox="0 0 24 24">
							<path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
							<polyline points="14 2 14 8 20 8"></polyline>
							<line y2="13" x2="8" y1="13" x1="16"></line>
							<line y2="17" x2="8" y1="17" x1="16"></line>
							<polyline points="10 9 9 9 8 9"></polyline>
						</svg>Sales Report</div>
					<div class="download">
						<svg class="css-i6dzq1" stroke-linejoin="round" stroke-linecap="round" fill="none"
							stroke-width="2" stroke="currentColor" height="24" width="24" viewBox="0 0 24 24">
							<path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
							<polyline points="7 10 12 15 17 10"></polyline>
							<line y2="3" x2="12" y1="15" x1="12"></line>
						</svg>
					</div>
				</button>
			</div>

			<ul class="box-info">
				<li>
					<i class='bx bxs-group'></i>

					<span class="text">
						<% if(typeof countUser !=='undefined' ){ %>
							<h3>
								<%= countUser %>
							</h3>
							<% }else{ %>
								<h3>No users</h3>
								<% } %>
									<p>Users</p>
					</span>
				</li>
				<li>
					<i class='bx bxs-calendar-check'></i>
					<span class="text">
						<% if(typeof ordercount !=='undefined' ){ %>
							<h3>
								<%= ordercount %>
							</h3>
							<% }else{ %>
								<h3>No Order</h3>
								<% } %>
									<p>Total Order</p>
					</span>
				</li>
				<li>
					<i class='bx bxs-dollar-circle'></i>
					<span class="text">
						<% if(typeof orderTotalAmount !=='undefined' ){ %>
							<h3>$<%= orderTotalAmount %>
							</h3>
							<% }else{ %>
								<h3>No Sales</h3>
								<% } %>
									<p>Total Sales</p>
					</span>
				</li>
			</ul>



		</main>

		<div
			style="margin-bottom: 10px; background-color: rgba(248, 248, 248, 0.659); padding: 10px; margin-left: 20px; margin-right: 20px; border: rgba(0, 0, 0, 0.112) 1px solid; border-radius: 5px;">
			<b>
				<h2 style="text-align: center;">TOP SELLING PRODUCTS</h2>
			</b>
			<br>
			<table style="width: 100%; border-collapse: collapse;">
				<thead>
					<tr>
						<th
							style="border: 1px solid #434343; padding: 8px; background-color: #1818181a; text-align: left;">
							Product Name</th>
						<th
							style="border: 1px solid #434343; padding: 8px; background-color: #1818181a; text-align: left;">
							Quantity Sold</th>
					</tr>
				</thead>
				<tbody>
					<% if (topProducts.length !==0) { %>
						<% for (let i=0; i < topProducts.length; i++) { %>
							<tr>
								<td style="border: 1px solid rgb(0, 0, 0); padding: 8px; text-align: left;">
									<%= topProducts[i].productName %>
								</td>
								<td style="border: 1px solid #000000; padding: 8px; text-align: left;">
									<%= topProducts[i].totalQuantitySold %>
								</td>
							</tr>
							<% } %>
								<% } %>
				</tbody>
			</table>
		</div>
		<!-- MAIN -->
		<div
			style="margin-bottom: 10px; background-color: rgba(248, 248, 248, 0.659); padding: 10px; margin-left: 20px; margin-right: 20px; border: rgba(0, 0, 0, 0.196) 1px solid; border-radius: 5px; ">
			<b>
				<h2 style="text-align: center;">TOP SELLING CATEGORY</h2>
			</b>
			<br>
			<table style="width: 100%; border-collapse: collapse;">
				<thead>
					<tr>
						<th
							style="border: 1px solid #434343; padding: 8px; background-color: #1818181a; text-align: left;">
							Category Name</th>
						<th
							style="border: 1px solid #434343; padding: 8px; background-color: #1818181a; text-align: left;">
							Quantity Sold</th>
					</tr>
				</thead>
				<tbody>
					<% if (topCategory.length !==0) { %>
						<% for (let i=0; i < topCategory.length; i++) { %>
							<tr>
								<td style="border: 1px solid rgb(0, 0, 0); padding: 8px; text-align: left;">
									<%= topCategory[i]._id %>
								</td>
								<td style="border: 1px solid #000000; padding: 8px; text-align: left;">
									<%= topCategory[i].totalQuantitySold %>
								</td>
							</tr>
							<% } %>
								<% } %>
				</tbody>
			</table>
		</div>

		<select id="intervalSelect" onchange="updateChart()"
			style="background-color: rgb(255, 255, 255); width: 100px; height: 25px; margin-top: 10px; margin-left: 10px;">
			<option value="daily">Daily</option>
			<option value="weekly">Weekly</option>
			<option value="monthly">Monthly</option>
			<option value="yearly">Yearly</option>
		</select>
		<div style="width: 90%;">
			<canvas id="myChart"></canvas>
		</div>
	</section>




	<!-- <div id="myModal" class="modal">
		<div class="modal-content">
			<span class="close" onclick="closeModal()">&times;</span>
			<h2 style="padding: 10px; margin-bottom: 10px;"><b>Report</b></h2>
			<a href="/dailyReportDownload"><button
					style="width: 80px; color: white;  height: 30px; background-color: rgb(0, 0, 0);"><b>Daily</b></button></a>
			<a href="/weeklyReportDownload"><button
					style="width: 80px; color: white; height: 30px; background-color: rgb(0, 0, 0);"><b>Weekly</b></button></a>
			<a href="/yearlyReportDownload"><button
					style="width: 80px; color: white; height: 30px; background-color: rgb(0, 0, 0);"><b>Yearly</b></button></a>
						<br><br>
			<form action="/costomeDateSalesReport" method="post">
				<input type="date" name="fromDate" id="date" placeholder="22-11-2002" required>
				<input type="date" name="toDate" id="date" placeholder="22-11-2002" required>
				<button type="submit">Download</button>
			</form>
		</div>
	</div> -->

	<div id="myModal" class="modal ">
		<div class="modal-content">
			<span class="close" onclick="closeModal()">&times;</span>
			<h2 style="padding: 10px; margin-bottom: 10px;"><b>Report</b></h2>
			<!-- daily -->
			<a href="/dailyReportPreview"><button
					style="width: 80px; color: white;  height: 30px; background-color: rgb(0, 0, 0);"><b>Daily</b></button></a>
			<!-- daily end modal -->

			<!-- weekly -->
			<a href="/weeklyReportPreview"><button
					style="width: 80px; color: white; height: 30px; background-color: rgb(0, 0, 0);"><b>Weekly</b></button><a
					href=""></a>
				<!-- end weekly -->

				<!-- yearly -->
				<a href="/yearlyReportPreview"><button
						style="width: 80px; color: white; height: 30px; background-color: rgb(0, 0, 0);"><b>Yearly</b></button></a>
				<!-- end year -->
				<br><br>
				<form action="/costomeDateSalesReport" method="post">
					<input type="date" name="fromDate" id="date" required>
					<input type="date" name="toDate" id="date" required>
					<button type="submit">Download</button>
				</form>
		</div>
	</div>

	<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"
		integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g=="
		crossorigin="anonymous" referrerpolicy="no-referrer"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.min.js"></script>
	<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"
		integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g=="
		crossorigin="anonymous"></script>


	<script src="js/adminhome.js"></script>

	<script>
		// Function to update chart based on selected interval
		function updateChart() {
			var interval = document.getElementById('intervalSelect').value;

			// Making AJAX request
			$.ajax({
				type: 'POST',
				url: '/admin/chartData',
				data: { filter: interval },
				success: function (response) {

					var labels = response.label;
					var salesCount = response.salesCount;

					myChart.data.labels = labels;
					myChart.data.datasets[0].data = salesCount;
					myChart.update();
				},
				error: function (xhr, status, error) {
					console.error(error);
				}
			});
		}

		var data = {
			labels: [],
			datasets: [{
				label: 'Sales Count',
				backgroundColor: '#27ae60',
				borderColor: 'rgb(255, 99, 132)',
				data: []
			}]
		};

		var config = {
			type: 'bar',
			data: data,
			options: {
				scales: {
					yAxes: [{
						ticks: {
							beginAtZero: true
						}
					}]
				}
			}
		};

		var ctx = document.getElementById('myChart').getContext('2d');
		var myChart = new Chart(ctx, config);
		updateChart();
	</script>

	<script>
		// Get today's date in the format YYYY-MM-DD
		var today = new Date().toISOString().split('T')[0];

		// Set the max attribute of the date inputs to today's date
		document.getElementById('from-date').max = today;
		document.getElementById('to-date').max = today;
	</script>
	<script>
		function openModal() {
			document.getElementById("myModal").style.display = "block";
		}

		function closeModal() {
			document.getElementById("myModal").style.display = "none";
		}

		function generateReport(reportType) {

		}

		function generateCustomReport() {

		}

	</script>
</body>

</html>